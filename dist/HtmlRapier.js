jsns.runAmd(function(t){t(["require","exports"],function(t,e){"use strict";!function(){function t(t){function e(){}function n(t,e){return function(){t.apply(e,arguments)}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function i(t,e){for(;3===t._state;)t=t._value;return 0===t._state?void t._deferreds.push(e):(t._handled=!0,void r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?o:a)(e.promise,t._value);var r;try{r=n(t._value)}catch(t){return void a(e.promise,t)}o(e.promise,r)}))}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if(e instanceof r)return t._state=3,t._value=e,void u(t);if("function"==typeof i)return void c(n(i,e),t)}t._state=1,t._value=e,u(t)}catch(e){a(t,e)}}function a(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function s(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,o(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}var l=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var r=new this.constructor(e);return i(this,new s(t,n,r)),r},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function r(o,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var u=a.then;if("function"==typeof u)return void u.call(a,function(t){r(o,t)},n)}e[o]=a,0===--i&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var i=e.length,o=0;o<e.length;o++)r(o,e[o])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},r._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){l(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},t.Promise=r}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;--n>=0&&e.item(n)!==this;);return n>-1}),"undefined"==typeof window.Promise&&t(window),"undefined"==typeof Array.isArray&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})}()})}),jsns.amd("hr.anticsrf",function(t){t(["require","exports","hr.http","hr.uri"],function(t,e,n,r){"use strict";function i(t){var e,r,i;n.post(t).then(function(t){if(e=t.headerName,r=t.requestToken,void 0!==i)for(var n=0;n<i.length;++i)i[n].resolve()}).catch(function(t){if(void 0!==i)for(var e=0;e<i.length;++i)i[e].reject()}),this.modifyPromise=function(n,r){if(void 0===e&&n!==t)return void 0===i&&(i=[]),new Promise(function(t,e){i.push({resolve:t,reject:e})})},this.modifyRequest=function(n,i,o){i!==t&&n.setRequestHeader(e,r)}}function o(t){var e=a(t);void 0===c[e]&&(l&&(l=!1,n.customizeRequest.add(null,s),n.customizePromise.add(null,u)),c[e]=new i(t))}function a(t){return r.parseUri(t).authority.toLowerCase()}function u(t,e){var n=a(t),r=c[n];if(void 0!==r)return r.modifyPromise(t,e)}function s(t,e,n){var r=a(e),i=c[r];void 0!==i&&i.modifyRequest(t,e,n)}var c={},l=!0;e.getToken=o})}),jsns.amd("hr.bindingcollection",function(t){t(["require","exports","hr.domquery","hr.toggles","hr.models"],function(t,e,n,r,i){"use strict";function o(t,e){this.execute=function(n){var r=e[t];r&&r.call(this,n)}}function a(t,e){for(var r=0;r<t.length;++r){var i=t[r];n.iterateNodes(i,NodeFilter.SHOW_ELEMENT,function(t){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];if(r.name.startsWith("data-hr-on-")){var i=r.value;if(e[i]){var a=new o(i,e);t.addEventListener(r.name.substr(11),a.execute)}}}})}}function u(t,e,i){for(var o,a="[data-hr-toggle="+t+"]",u=0;u<e.length;++u){var s=e[u],c=n.first(a,s);if(c)return o=r.build(c,i);o=null}return null===o&&(o=r.build(null,i)),o}function s(t,e){for(var r,o="[data-hr-model="+t+"]",a=0;a<e.length;++a){var u=e[a],s=n.first(o,u);if(s)return r=i.build(s);r=null}return null===r&&(r=new i.NullModel),r}function c(t,e){for(var r="[data-hr-handle="+t+"]",i=0;i<e.length;++i){var o=e[i],a=n.first(r,o);if(a)return a}return null}function l(t){for(var e={},r=0;r<t.length;++r){var i=t[r];n.iterateNodes(i,NodeFilter.SHOW_ELEMENT,function(t){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];r.name.startsWith("data-hr-config-")&&(e[r.name.substr(15)]=r.value)}})}return e}function f(t,e,r){for(var i=0;i<e.length;++i){var o=e[i];n.iterate('[data-hr-controller="'+t+'"]',o,function(t){r(t)})}}function h(t){t=n.all(t),this.setListener=function(e){a(t,e)},this.getToggle=function(e,n){return u(e,t,n)},this.getModel=function(e){return s(e,t)},this.getConfig=function(){return l(t)},this.getHandle=function(e){return c(e,t)},this.iterateControllers=function(e,n){f(e,t,n)}}e.BindingCollection=h})}),jsns.runAmd(function(t){t(["require","exports","hr.bindingcollection","hr.textstream","hr.components","hr.ignored","hr.iterable"],function(t,e,n,r,i,o,a){"use strict";function u(t,e,r,i){for(var o=e.format(t),a=b(o),u=[],s=0;s<a.length;++s){var c=a[s];r.insertBefore(c,i),u.push(c)}return new n.BindingCollection(u)}function s(t){function e(e,i,u){return o=new r.TextStream(t),a=n,n(e,i,u)}function n(t,e,n){return u(t,o,e,n)}function i(t,e,n){return a(t,e,n)}var o,a=e;this.create=i}function c(t){function e(e,i,o){return a=new r.TextStream(t),c=n,n(e,i,o)}function n(t,e,n){return u(t,a,e,n)}function i(t,e,n,r){return null!==r&&s.hasOwnProperty(r)?s[r].create(t,e,n):c(t,e,n)}function o(t,e){s[t]=e}var a,s={},c=e;this.create=i,this.addVariant=o}function l(t){if(t.length>0){var e=t[t.length-1].next();if(e.done)return t.pop(),l(t);var n=e.value,r=document.createElement("div");r.appendChild(document.importNode(n.content,!0));var i=r.getElementsByTagName("TEMPLATE");return i.length>0&&t.push(new a.Iterable(Array.prototype.slice.call(i)).iterator()),{element:n,templateElement:r}}}function f(t,e){var n=t.element;if(g=v.next(),o.isIgnored(n))return e;for(var r=t.templateElement;!g.done&&r.contains(g.value.element);)var e=f(g.value,e);var a=r.innerHTML.trim();if(1===r.childElementCount&&"TABLE"===r.firstElementChild.tagName&&!n.hasAttribute("data-hr-keep-table")){var u=r.firstElementChild;a=u.childElementCount>0&&"TBODY"===u.firstElementChild.tagName?u.firstElementChild.innerHTML.trim():u.innerHTML.trim()}var l=n.parentNode;l.removeChild(n);var h=n.getAttribute("data-hr-variant"),m=n.getAttribute("data-hr-component");if(null===h){null===m&&(m="AnonTemplate_"+d++,l.setAttribute("data-hr-model-component",m));var y=new c(a);return p[m]=y,i.register(m,y.create),y}return null===m?void 0!==e?e.addVariant(h,new s(a)):console.log('Attempted to create a variant named "'+h+'" with no default component in the chain. Please start your template element chain with a data-hr-component or a anonymous template. This template has been ignored.'):p[m].addVariant(h,new s(a)),e}var h="content"in document.createElement("template"),d=0,p={},v=new a.Iterable(Array.prototype.slice.call(document.getElementsByTagName("TEMPLATE")));if(h){var m=[];m.push(v.iterator()),v=new a.Iterable(function(){return l(m)})}else v=v.select(function(t){return{element:t,templateElement:t}});v=v.iterator();for(var g=v.next();!g.done;)var y=f(g.value,y);var b=function(t){var e={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],body:[0,"",""],_default:[1,"<div>","</div>"]};e.optgroup=e.option,e.tbody=e.tfoot=e.colgroup=e.caption=e.thead,e.th=e.td;var n=/<\s*\w.*?>/g.exec(t),r=document.createElement("div");if(null!=n){var r,i=n[0].replace(/</g,"").replace(/>/g,"").split(" ")[0],o=e[i]||e._default;t=o[1]+t+o[2],r.innerHTML=t;for(var a=o[0];a--;)r=r.lastChild}else r.innerHTML=t;return r.childNodes}})}),jsns.amd("hr.components",function(t){t(["require","exports","hr.typeidentifiers","hr.domquery"],function(t,e,n,r){"use strict";function i(t,e){l[t]=e}function o(){return null}function a(t,e,r,i,a){return void 0===a?a=o():n.isFunction(a)&&(a=a(r)),c(t,r,e,null,a,i)}function u(t,e,r,i,a){void 0===a&&(a=o);for(var u,s=null,s=e.firstElementChild;null!=s&&!s.hasAttribute("data-hr-insert");)s=s.nextElementSibling;var l=document.createDocumentFragment();if(n.isArray(r))for(var f=0;f<r.length;++f)u=a(r[f]),c(t,r[f],l,null,u,i);else n.isForEachable(r)&&r.forEach(function(e){u=a(e),c(t,e,l,null,u,i)});e.insertBefore(l,s)}function s(t){for(var e=r.first(t),n=e.firstChild,i=null;null!=n;)i=n.nextSibling,1===n.nodeType&&n instanceof HTMLElement&&n.hasAttribute("data-hr-keep")||e.removeChild(n),n=i}function c(t,e,n,i,o,a){if(n=r.first(n),l.hasOwnProperty(t)){var u=l[t](e,n,i,o);return void 0!==a&&null!==a&&a(u,e),u}console.log("Failed to create component '"+t+"', cannot find factory, did you forget to define it on the page?")}var l={};e.register=i,e.single=a,e.repeat=u,e.empty=s})}),jsns.amd("hr.controller",function(t){t(["require","exports","hr.bindingcollection","hr.domquery","hr.ignored","hr.eventhandler"],function(t,e,n,r,i,o){"use strict";function a(t,e,o,a){function u(t){if(!i.isIgnored(t)){var r=new n.BindingCollection(t),a=new e(r,o,null);r.setListener(a),t.removeAttribute("data-hr-controller"),s.push(a)}}var s=[];return a?a.iterateControllers(t,u):r.iterate('[data-hr-controller="'+t+'"]',null,u),s}function u(t,e){var n=new s(t);return n.context=e,n.createOnCallback()}e.create=a,e.createOnCallback=u;var s=function(){function t(t){this.controllerConstructor=t,this.controllerCreatedEvent=new o.EventHandler}return Object.defineProperty(t.prototype,"context",{get:function(){return this._context},set:function(t){this._context=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controllerCreated",{get:function(){return this.controllerCreatedEvent.modifier},enumerable:!0,configurable:!0}),t.prototype.createOnCallback=function(){var t=this;return function(e,n){var r=new t.controllerConstructor(e,t.context,n);e.setListener(r),t.controllerCreatedEvent.fire(r)}},t}();e.ControllerBuilder=s})}),jsns.amd("hr.cookies",function(t){t(["require","exports"],function(t,e){"use strict";function n(t,e,n){if(n){var r=new Date;r.setTime(r.getTime()+24*n*60*60*1e3);var i="; expires="+r.toUTCString()}else var i="";document.cookie=t+"="+e+i+"; path=/"}function r(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return null}function i(t){n(t,"",-1)}e.create=n,e.read=r,e.erase=i})}),jsns.amd("hr.domquery",function(t){t(["require","exports","hr.typeidentifiers"],function(t,e,n){"use strict";function r(t,e){return"string"==typeof t?void 0!==e?this.matches(e,t)?e:e.querySelector(t):document.querySelector(t):t instanceof Node?t:void 0}function i(t,e,n){if("string"==typeof t)void 0===n&&(n=[]),void 0!==e?this.matches(e,t)?n.push(e):c(e.querySelectorAll(t),n):c(document.querySelectorAll(t),n);else if(t instanceof HTMLElement)void 0===n?n=[t]:n.push(t);else if(void 0===n)n=t;else for(var r=0;r<t.length;++r)n.push(t[r]);return n}function o(t,e,r){if(n.isString(t))e?this.matches(e,t)?r(e):l(e.querySelectorAll(t),r):l(document.querySelectorAll(t),r);else if(n.isArray(t))for(var i=0;i<t.length;++i)r(t[i]);else r(t)}function a(t){return!0}function u(t,e,n){for(var r,i=document.createNodeIterator(t,e,a,!1);r=i.nextNode();)n(r)}function s(t,e){return t.matches(e)}function c(t,e){for(var n=0;n<t.length;++n)e.push(t[n])}function l(t,e){for(var n=0;n<t.length;++n)e(t[n])}e.first=r,e.all=i,e.iterate=o,e.iterateNodes=u,e.matches=s})}),jsns.amd("hr.escape",function(t){t(["require","exports"],function(t,e){"use strict";function n(t){t=String(t);for(var e={textStart:0,bracketStart:0,output:""},n=0;n<t.length;++n)switch(t[n]){case"<":r(n,t,e,"&lt;");break;case">":r(n,t,e,"&gt;");break;case'"':r(n,t,e,"&quot;");break;case"'":r(n,t,e,"&#39;")}return e.textStart<t.length&&(e.output+=t.substring(e.textStart,t.length)),e.output}function r(t,e,n,r){n.bracketStart=t,n.output+=e.substring(n.textStart,n.bracketStart)+r,n.textStart=t+1}e.escape=n})}),jsns.amd("hr.eventhandler",function(t){t(["require","exports"],function(t,e){"use strict";var n=function(){function t(){var t=this;this.handlers=[],this.modifier={add:function(e,n){return t.add(e,n)},remove:function(e,n){return t.remove(e,n)}}}return t.prototype.add=function(t,e){if(void 0===t)throw"context cannot be undefined";if(void 0===e)throw"handler cannot be undefined";this.handlers.push({handler:e,context:t})},t.prototype.remove=function(t,e){for(var n=0;n<this.handlers.length;++n)this.handlers[n].handler===e&&this.handlers[n].context===t&&this.handlers.splice(n--,1)},t.prototype.fire=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n,r,i=0;i<this.handlers.length;++i){var o=this.handlers[i];r=o.handler.apply(o.context,t),void 0!==r&&(void 0===n&&(n=[]),n.push(r))}return n},t}();e.EventHandler=n})}),jsns.amd("hr.form",function(t){t(["require","exports","hr.domquery","hr.typeidentifiers"],function(t,e,n,r){"use strict";function i(t,e,n){if(void 0===t[e])t[e]=n;else if(r.isArray(t[e]))t[e].push(n);else{var i=t[e];t[e]=[i,n]}}function o(t){if(t=n.first(t),t&&"FORM"===t.nodeName){var e,r,o={};for(e=t.elements.length-1;e>=0;e-=1)if(""!==t.elements[e].name)switch(t.elements[e].nodeName){case"INPUT":switch(t.elements[e].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":case"file":i(o,t.elements[e].name,t.elements[e].value);break;case"checkbox":case"radio":t.elements[e].checked&&i(o,t.elements[e].name,t.elements[e].value)}break;case"TEXTAREA":i(o,t.elements[e].name,t.elements[e].value);break;case"SELECT":switch(t.elements[e].type){case"select-one":i(o,t.elements[e].name,t.elements[e].value);break;case"select-multiple":for(r=t.elements[e].options.length-1;r>=0;r-=1)t.elements[e].options[r].selected&&i(o,t.elements[e].name,t.elements[e].options[r].value)}break;case"BUTTON":switch(t.elements[e].type){case"reset":case"submit":case"button":i(o,t.elements[e].name,t.elements[e].value)}}return o}}function a(t,e){var i=n.first(t),o=n.all("[name]",i);if(r.isObject(e))for(var a=0;a<o.length;++a){var u=o[a];u.value=e[u.getAttribute("name")]}else if(r.isFunction(e))for(var a=0;a<o.length;++a){var u=o[a];switch(u.type){case"checkbox":u.checked=e(u.getAttribute("name"))===u.value;break;default:u.value=e(u.getAttribute("name"))}}}e.serialize=o,e.populate=a})}),jsns.amd("hr.formlifecycle",function(t){t(["require","exports","hr.toggles","hr.http"],function(t,e,n,r){"use strict";function i(t){var e=null,i=this;t.setListener({submit:function(t){t.preventDefault(),i.submit()},tryAgain:function(t){t.preventDefault(),e()}});var o=t.getToggle("load"),a=t.getToggle("main"),u=t.getToggle("fail"),s=new n.Group(o,a,u),c=t.getModel("settings");this.populate=function(){s.show(o),r.get(c.getSrc()).then(function(t){c.setData(t),s.show(a)}).catch(function(t){e=i.populate,s.show(u)})},this.submit=function(){s.show(o);var t=c.getData();r.post(c.getSrc(),t).then(function(t){s.show(a)}).catch(function(t){e=i.submit,s.show(u)})}}e.FormLifecycle=i})}),jsns.amd("hr.http",function(t){t(["require","exports","hr.eventhandler"],function(t,e,n){"use strict";function r(t){var e,n=t.getResponseHeader("content-type");if(n&&n.search(/application\/json/)!==-1)try{e=JSON.parse(t.response)}catch(n){e=t.response}else e=t.response;return e}function i(t,e,n){t.status>199&&t.status<300?void 0!==e&&e(r(t)):void 0!==n&&n(r(t))}function o(t,e){return c(t,"POST",e)}function a(t,e){return c(t,"PUT",e)}function u(t,e){return c(t,"DELETE",e)}function s(t,e){return void 0!==e&&e!==!1||(t+=t.indexOf("?")>-1?"&":"?",t+="noCache="+(new Date).getTime()),f(t,"GET",function(){},function(){var e=new XMLHttpRequest;return e.open("GET",t),e})}function c(t,e,n){return f(t,e,function(){return JSON.stringify(n)},function(){var n=new XMLHttpRequest;return n.open(e,t),n.setRequestHeader("Content-Type","application/json"),n})}function l(t,e){return f(t,"POST",function(){var t=null;return e instanceof FormData?t=e:(t=new FormData,t.append("file",e)),t},function(){var e=new XMLHttpRequest;return e.open("POST",t),e})}function f(t,e,n,r){var i=p.fire(t,e);return void 0===i||0===i.length?h(t,e,n,r):Promise.all(i).then(function(i){return h(t,e,n,r)})}function h(t,e,n,r){return new Promise(function(o,a){var u=r();u.withCredentials=!0,d.fire(u,t,e),u.onload=function(){i(u,o,a)};var s=n();void 0===s?u.send():u.send(s)})}var d=new n.EventHandler;e.customizeRequest=d.modifier;var p=new n.EventHandler;e.customizePromise=p.modifier,e.post=o,e.put=a,e.del=u,e.get=s,e.ajax=c,e.upload=l})}),jsns.amd("hr.ignored",function(t){t(["require","exports","hr.domquery"],function(t,e,n){"use strict";function r(t){for(var e=0;e<i.length;++e)if(i[e].contains(t))return!0;return!1}var i=n.all("[data-hr-ignored]");e.isIgnored=r})}),jsns.amd("hr.iterable",function(t){t(["require","exports","hr.typeidentifiers"],function(t,e,n){"use strict";function r(){function t(t){n.push(t)}function e(t){for(var e=t,r=n.length-1;r>=0&&void 0!==e;--r)e=n[r](e);return e}var n=[];this.push=t,this.derive=e}function i(t,e){var r;return n.isArray(t)?(r=0,{next:function(){for(var n=void 0;void 0===n&&r<t.length;){var i=t[r++];n=e.derive(i)}return void 0===n?new f((!0)):new f((!1),n)}}):n.isFunction(t)?{next:function(){for(var n=void 0;void 0===n;){var r=t();if(void 0===r)break;n=e.derive(r)}return void 0===n?new f((!0)):new f((!1),n)}}:void 0}function o(t,e,r){var i;if(n.isArray(t))for(i=0;i<t.length;++i){var o=t[i],a=e.derive(o);void 0!==a&&r(a)}}function a(t,e,n,r){return n.push(e),t(n,r)}function u(t){this.select=function(e){return new s(e,t)},this.where=function(e){return new c(e,t)},this.forEach=function(e){t(new r).forEach(e)},this.iterator=function(){return t(new r).iterator()}}function s(t,e){function n(n,r){return a(e,t,n,r)}u.call(this,n)}function c(t,e){function n(t,n){return a(e,r,t,n)}function r(e){if(t(e))return e}u.call(this,n)}function l(t){function e(e){return{forEach:function(n){o(t,e,n)},iterator:function(){return i(t,e)}}}u.call(this,e)}var f=(new r,function(){function t(t,e){this.done=t,this.value=e}return t}());e.Iterable=l})}),jsns.amd("hr.lateboundeventhandler",function(t){t(["require","exports","hr.eventhandler"],function(t,e,n){"use strict";function r(){function t(t,e){if(a.modifier.add(t,e),null!==u){s=i;for(var n=0;n<u.length;++n)o.apply(this,u[n]);u=null}}function e(t,e){a.modifier.remove(t,e)}function r(){u.push(arguments)}function i(){a.fire.apply(a,arguments)}function o(){return s.apply(this,arguments)}var a=new n.EventHandler,u=[],s=r;this.modifier={add:t,remove:e},this.fire=o}e.LateBoundEventHandler=r})}),jsns.amd("hr.models",function(t){t(["require","exports","hr.form","hr.textstream","hr.components","hr.typeidentifiers","hr.domquery"],function(t,e,n,r,i,o,a){"use strict";function u(t){return""}function s(t,e){function r(){n.populate(t,u)}this.setData=function(e){n.populate(t,e)},this.appendData=this.setData,this.clear=r,this.getData=function(){return n.serialize(t)},this.getSrc=function(){return e}}function c(t,e,n){function r(){i.empty(t)}this.setData=function(e,n,r){i.empty(t),this.appendData(e,n,r)},this.appendData=function(e,r,a){o.isArray(e)||o.isForEachable(e)?i.repeat(n,t,e,r,a):void 0!==e&&null!==e&&i.single(n,t,e,r,a)},this.clear=r,this.getData=function(){return{}},this.getSrc=function(){return e}}function l(t,e){function n(){r=f(u,t,r)}var r=void 0;this.setData=function(e){r=f(e,t,r)},this.clear=n,this.appendData=this.setData,this.getData=function(){return{}},this.getSrc=function(){return e}}function f(t,e,n){if(void 0===n)n=[],a.iterateNodes(e,NodeFilter.SHOW_TEXT,function(e){var i=new r.TextStream(e.textContent);i.foundVariable()&&(e.textContent=i.format(t),n.push({node:e,stream:i}))});else for(var i=0;i<n.length;++i){var o=n[i];o.node.textContent=o.stream.format(t)}return n}function h(t){var e=t.getAttribute("data-hr-model-src");if("FORM"===t.nodeName||"INPUT"==t.nodeName||"TEXTAREA"==t.nodeName)return new s(t,e);var n=t.getAttribute("data-hr-model-component");return n?new c(t,e,n):new l(t,e)}function d(){this.setData=function(t){},this.appendData=this.setData,this.clear=function(){},this.getData=function(){return{}},this.getSrc=function(){return""}}e.build=h,e.NullModel=d})}),jsns.amd("hr.promiseeventhandler",function(t){t(["require","exports"],function(t,e){"use strict";function n(){function t(t,e){if(void 0===t)throw"context cannot be undefined";if(void 0===e)throw"handler cannot be undefined";r.push({handler:e,context:t})}function e(t,e){for(var n=0;n<r.length;++n)r[n].handler===e&&r[n].context===t&&r.splice(n--,1)}function n(){for(var t,e=[],n=0;n<r.length;++n){var i=r[n];e.push(new Promise(function(t,e){t(i.handler.apply(i.context,arguments))}).then(function(e){void 0!==e&&(void 0===t&&(t=[]),t.push(e))}))}return Promise.all(e).then(function(e){return t})}var r=[];this.modifier={add:t,remove:e},this.fire=n}e.PromiseEventHandler=n})}),jsns.amd("hr.promiseutils",function(t){t(["require","exports"],function(t,e){"use strict";function n(t){var e={},n=new Promise(function(n,r){if(e.resolve=n,e.reject=r,void 0!==t)return t(n,r)});return e.promise=n,e}e.ExternalPromise=n})}),jsns.amd("hr.storage",function(t){t(["require","exports"],function(t,e){"use strict";function n(t,e){void 0===e&&(e=null);var n=sessionStorage.getItem(t);return n=null!==n?JSON.parse(n):e}function r(t,e){sessionStorage.setItem(t,JSON.stringify(e))}e.getSessionJson=n,e.storeJsonInSession=r})}),jsns.amd("hr.textstream",function(t){t(["require","exports","hr.escape","hr.typeidentifiers"],function(t,e,n,r){"use strict";function i(t){this.writeObject=function(e){return t},this.writeFunction=this.writeObject}function o(t){this.writeObject=function(e){return n.escape(e[t])},this.writeFunction=function(e){return n.escape(e(t))}}function a(){this.writeObject=function(t){return n.escape(t)},this.writeFunction=function(t){return n.escape(t("this"))}}function u(t,e){null!==t&&void 0!==t||(t={});var n="";if(r.isFunction(t))for(var i=0;i<e.length;++i)n+=e[i].writeFunction(t);else for(var i=0;i<e.length;++i)n+=e[i].writeObject(t);return n}function s(t){for(var e,n,r,s=[],c=!1,l=0,f=0,h=0,d=0,p=0,v="",m=0;m<t.length;++m)if("{"==t[m]){for(f=m,d=1;++m<t.length&&"{"==t[m];)++d;for(p=d;++m<t.length&&!("}"==t[m]&&0==--p||/\s/.test(t[m])););if(0==p){switch(e=t.substring(l,f),h=m,r=t.substring(f,h+1),d){case 1:v+=e+r;break;case 2:s.push(new i(v+e)),v="",n=r.substring(2,r.length-2),"this"===n?s.push(new a):s.push(new o(n));break;default:v+=e+r.substring(1,r.length-1)}l=m+1,c=!0}}l<t.length&&s.push(new i(v+t.substring(l,t.length))),this.format=function(t){return u(t,s)},this.foundVariable=function(){return c}}e.TextStream=s})}),jsns.amd("hr.timedtrigger",function(t){t(["require","exports","hr.eventhandler"],function(t,e,n){"use strict";function r(t){function e(t){l=t}function r(){clearTimeout(s),c=void 0}function i(){r(),s=window.setTimeout(u,l),c=arguments}function o(t,e){f.modifier.add(t,e)}function a(t,e){f.modifier.remove(t,e)}function u(){f.fire.apply(f,c)}void 0===t&&(t=400);var s,c,l=t,f=new n.EventHandler;this.handler=f.modifier,this.setDelay=e,this.cancel=r,this.fire=i,this.addListener=o,this.removeListener=a}e.TimedTrigger=r})}),jsns.amd("hr.toggles",function(t){t(["require","exports","hr.typeidentifiers"],function(t,e,n){"use strict";function r(t){p.push(t)}function i(t,e){if(t){var n=t[e];if(n)n();else{var r=t.applyState(null);i(r,e)}}}function o(t,e,n){function r(){var r=n.applyState(e);i(r,t)}n[t]=r}function a(t){function e(e){return t}this.applyState=e}function u(t,e){function n(n){return n?t.style.cssText=r+n:t.style.cssText=r,e}var r=t.style.cssText||"";this.applyState=n}function s(t,e){function n(n){return n?t.setAttribute("class",o+" "+n):t.setAttribute("class",o),r(),e}function r(){a&&(t.classList.remove(a),t.removeEventListener("transitionend",i),t.removeEventListener("animationend",i),t.addEventListener("transitionend",i),t.addEventListener("animationend",i))}function i(){t.removeEventListener("transitionend",i),t.removeEventListener("animationend",i),t.classList.add(a)}var o=t.getAttribute("class")||"",a=t.getAttribute("data-hr-class-idle");this.applyState=n}function c(){function t(t){n.push(t)}function e(t,e,r){void 0===e&&(e="on"),void 0===r&&(r="off");for(var o=0;o<n.length;++o)i(n[o],r);i(t,e)}for(var n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];this.add=t,this.activate=e,this.show=e}function l(t,e,n,r,i){for(var a=null,u=0;u<e.length;++u){var s=e[u],c=n+s;if(t.hasAttribute(c)){var l=t.getAttribute(c);null===a&&(a=new r(t,i)),o(s,l,a)}}return a?a:i}function f(t,e){void 0===e&&(e=d);var r=null;if(null!==t){r=l(t,e,"data-hr-style-",u,r),r=l(t,e,"data-hr-class-",s,r);for(var i=0;i<p.length;++i)r=p[i](t,e,r)}for(null===r&&(r=new a(r)),i=0;i<e.length;++i){var c=e[i];n.isFunction(r[c])||o(c,null,r)}return r}function h(t){return n.isObject(t)&&t.constructor.prototype==a.prototype}var d=["on","off"],p=[];e.addTogglePlugin=r,e.Group=c,e.build=f,e.isNullToggle=h})}),jsns.amd("hr.typeidentifiers",function(t){t(["require","exports"],function(t,e){"use strict";function n(t){return Array.isArray(t)}function r(t){return"string"==typeof t}function i(t){return"function"==typeof t}function o(t){return"object"==typeof t}function a(t){return t&&i(t.forEach)}e.isArray=n,e.isString=r,e.isFunction=i,e.isObject=o,e.isForEachable=a})}),jsns.amd("hr.uri",function(t){t(["require","exports","hr.escape"],function(t,e,n){"use strict";function r(){for(var t=window.location.search.substr(1).split("&"),e={},r=0;r<t.length;++r){var i=t[r].split("=",2);1===i.length?e[i[0].toLowerCase()]="":i.length>0&&(e[i[0].toLowerCase()]=n.escape(decodeURIComponent(i[1].replace(/\+/g," "))))}return e}function i(t){return new a(t)}e.getQueryObject=r;var o={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},a=function(){function t(t){void 0===t&&void 0!==window&&(t=window.location.href);for(var e=o,n=e.parser[e.strictMode?"strict":"loose"].exec(t),r=this,i=14;i--;)r[e.key[i]]=n[i]||"";r[e.q.name]={},r[e.key[12]].replace(e.q.parser,function(t,n,i){n&&(r[e.q.name][n]=i)}),this.path=this.path.replace("\\","/")}return t.prototype.getPathPart=function(t){void 0===this.splitPath&&(this.splitPath=this.path.split("/"));var e=null;return t<0?-t<this.splitPath.length&&(e=this.splitPath[this.splitPath.length+t]):t<this.splitPath.length&&(e=this.splitPath[t]),null!==e&&(e=n.escape(e)),e},t}();e.Uri=a,e.parseUri=i})});
//# sourceMappingURL=HtmlRapier.js.map
