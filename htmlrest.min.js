"use strict";var jsns=function(){function t(t){return void 0!==a[t]}function e(t){return void 0!==l[t]}function n(t){var e=i(l[t]);return e&&delete l[t],e}function r(){this.exports={}}function i(i){for(var o=i.dependencies,s=!0,l=0;l<o.length;++l){var u=o[l];u.loaded=t(u.name),!u.loaded&&e(u.name)&&(u.loaded=n(u.name)),s=s&&u.loaded}if(s){var c=new r;i.name&&(a[i.name]=c);for(var f=[c.exports,c],l=0;l<o.length;++l){var u=o[l];f.push(a[u.name].exports)}i.factory.apply(c,f)}return s}function o(e,n,r){if(this.name=e,this.factory=r,this.dependencies=[],n)for(var i=0;i<n.length;++i){var o=n[i];this.dependencies.push({name:o,loaded:t(o)})}}function s(){for(var t=0;t<u.length;++t){var e=u[t];i(e)&&u.splice(t--,1)}}var a={},l={},u=[];return{run:function(t,e){u.push(new o(null,t,e)),s()},define:function(t,e,n){l[t]=new o(t,e,n),s()},debug:function(){if(u.length>0)for(var e=0;e<u.length;++e){var n=u[e];console.log("Runner waiting "+n);for(var r=0;r<n.dependencies.length;++r){var i=n.dependencies[r];t(i.name)||console.log("  dependency "+i.name)}}else console.log("No runners remaining.")}}}();!function(){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;--n>=0&&e.item(n)!==this;);return n>-1})}(),jsns.define("htmlrest.bindingcollection",["htmlrest.escape","htmlrest.typeidentifiers","htmlrest.domquery","htmlrest.textstream","htmlrest.toggles","htmlrest.models"],function(t,e,n,r,i,o,s,a){function l(t,e){this.execute=function(n){var r=e[t];r&&r.call(this,n)}}function u(t,e){for(var n=0;n<t.length;++n){var r=t[n];i.iterateNodes(r,NodeFilter.SHOW_ELEMENT,function(t){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];if(r.name.startsWith("data-hr-on-")){var i=new l(r.value,e);t.addEventListener(r.name.substr(11),i.execute)}}})}}function c(t,e,n){var r=n[t];if(void 0===r)for(var o="[data-hr-toggle="+t+"]",a=0;a<e.length;++a){var l=e[a],u=i.first(o,l);if(u)return r=s.build(u),n[t]=r,r;r=null}return null===r&&(r=new s.NullToggle),r}function f(t,e,n){var r=n[t];if(void 0===r)for(var o="[data-hr-model="+t+"]",s=0;s<e.length;++s){var l=e[s],u=i.first(o,l);if(u)return r=a.build(u),n[t]=r,r;r=null}return null===r&&(r=new a.NullModel),r}function d(t){for(var e={},n=0;n<t.length;++n){var r=t[n];i.iterateNodes(r,NodeFilter.SHOW_ELEMENT,function(t){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];r.name.startsWith("data-hr-config-")&&(e[r.name.substr(15)]=r.value)}})}return e}function h(t){t=i.all(t);var e=void 0,n=void 0,r=void 0;this.setListener=function(e){u(t,e)},this.setData=function(n){e=bindData(n,t,e)},this.getToggle=function(e){return void 0===n&&(n={}),c(e,t,n)},this.getModel=function(e){return void 0===r&&(r={}),f(e,t,r)},this.getConfig=function(){return d(t)}}e.exports=h}),jsns.run(["htmlrest.domquery","htmlrest.bindingcollection","htmlrest.textstream","htmlrest.components"],function(t,e,n,r,i,o){function s(t,e,n,i){for(var o=e.format(t),s=f(o),a=[],l=0;l<s.length;++l){var u=s[l];n.insertBefore(u,i),a.push(u)}return new r(a)}function a(t){var e=t.getAttribute("data-hr-component");null===e&&(e="AnonTemplate_"+u++,t.parentElement.setAttribute("data-hr-model-component",e));var n=t;if(l){var n=document.createElement("div");n.appendChild(document.importNode(t.content,!0))}for(var r=n.getElementsByTagName("TEMPLATE");r.length>0;)a(r[0]);var c=n.innerHTML.trim();if(1===n.childElementCount&&"TABLE"===n.firstElementChild.tagName&&!t.hasAttribute("data-hr-keep-table")){var f=n.firstElementChild;c=f.childElementCount>0&&"TBODY"===f.firstElementChild.tagName?f.firstElementChild.innerHTML.trim():f.innerHTML.trim()}t.parentNode.removeChild(t),o.register(e,function(t,n,r){var a=new i(c);return o.register(e,function(t,e,n){return s(t,a,e,n)}),s(t,a,n,r)})}for(var l=("content"in document.createElement("template")),u=0,c=document.getElementsByTagName("TEMPLATE");c.length>0;)a(c[0]);var f=function(t){var e={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],body:[0,"",""],_default:[1,"<div>","</div>"]};e.optgroup=e.option,e.tbody=e.tfoot=e.colgroup=e.caption=e.thead,e.th=e.td;var n=/<\s*\w.*?>/g.exec(t),r=document.createElement("div");if(null!=n){var r,i=n[0].replace(/</g,"").replace(/>/g,"").split(" ")[0],o=e[i]||e._default;t=o[1]+t+o[2],r.innerHTML=t;for(var s=o[0];s--;)r=r.lastChild}else r.innerHTML=t;return r.childNodes}}),jsns.define("htmlrest.components",["htmlrest.typeidentifiers","htmlrest.domquery"],function(t,e,n,r){function i(t,e,n,r){return l(t,n,e,null,r)}function o(t,e){u[t]=e}function s(t,e,r,i){for(var o=null,o=e.firstElementChild;null!=o&&!o.hasAttribute("data-htmlrest-insert");)o=o.nextElementSibling;var s=document.createDocumentFragment();if(Array.isArray(r))for(var a=0;a<r.length;++a)l(t,r[a],s,null,i);else if(n.isFunction(r))for(var u=r();null!=u;)l(t,u,s,null,i),u=r();else if(n.isObject(r))for(var c in r)l(t,r[c],s,null,i);e.insertBefore(s,o)}function a(t){t=r.first(t);for(var e=t.firstChild,n=null;null!=e;)n=e.nextSibling,1===e.nodeType&&e.hasAttribute("data-htmlrest-keep")||t.removeChild(e),e=n}function l(t,e,n,i,o){if(n=r.first(n),u.hasOwnProperty(t)){var s=u[t](e,n,i);return void 0!==o&&o(s,e),s}console.log("Failed to create component '"+t+"', cannot find factory, did you forget to define it on the page?")}var u={};t.single=i,t.register=o,t.repeat=s,t.empty=a}),jsns.define("htmlrest.controller",["htmlrest.bindingcollection","htmlrest.domquery"],function(t,e,n,r){function i(t,e,i){r.iterate('[data-hr-controller="'+t+'"]',null,function(t){var r=new n(t),o=new e(r,i,null);r.setListener(o),t.removeAttribute("data-hr-controller")})}function o(t,e){return function(n,r){var i=new t(n,e,r);n.setListener(i)}}t.create=i,t.createOnCallback=o}),jsns.define("htmlrest.domquery",["htmlrest.typeidentifiers"],function(t,e,n){function r(t,e){return n.isString(t)&&(t=void 0!==e?this.matches(e,t)?e:e.querySelector(t):document.querySelector(t)),t}function i(t,e,r){if(n.isString(t))void 0===r&&(r=[]),void 0!==e?this.matches(e,t)?r.push(e):u(e.querySelectorAll(t),r):u(document.querySelectorAll(t),r);else if(n.isArray(t))if(void 0===r)r=t;else for(var i=0;i<t.length;++i)r.push(t[i]);else void 0===r?r=[t]:r.push(t);return r}function o(t,e,r){if(n.isString(t))e?this.matches(e,t)?r(e):c(e.querySelectorAll(t),r):c(document.querySelectorAll(t),r);else if(n.isArray(t))for(var i=0;i<t.length;++i)r(t[i]);else r(t)}function s(t){return!0}function a(t,e,n){for(var r,i=document.createNodeIterator(t,e,s,!1);r=i.nextNode();)n(r)}function l(t,e){return t.matches(e)}function u(t,e){for(var n=0;n<t.length;++n)e.push(t[n])}function c(t,e){for(var n=0;n<t.length;++n)e(t[n])}t.first=r,t.all=i,t.iterate=o,t.iterateNodes=a,t.matches=l}),jsns.define("htmlrest.escape",null,function(t,e){function n(t){t=String(t);for(var e={textStart:0,bracketStart:0,output:""},n=0;n<t.length;++n)switch(t[n]){case"<":r(n,t,e,"&lt;");break;case">":r(n,t,e,"&gt;");break;case'"':r(n,t,e,"&quot;");break;case"'":r(n,t,e,"&#39;")}return e.textStart<t.length&&(e.output+=t.substring(e.textStart,t.length)),e.output}function r(t,e,n,r){n.bracketStart=t,n.output+=e.substring(n.textStart,n.bracketStart)+r,n.textStart=t+1}e.exports=n}),jsns.define("htmlrest.form",["htmlrest.domquery"],function(t,e,n){function r(t){if(t=n.first(t),t&&"FORM"===t.nodeName){var e,r,i={};for(e=t.elements.length-1;e>=0;e-=1)if(""!==t.elements[e].name)switch(t.elements[e].nodeName){case"INPUT":switch(t.elements[e].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":case"file":i[t.elements[e].name]=t.elements[e].value;break;case"checkbox":case"radio":t.elements[e].checked&&(i[t.elements[e].name]=t.elements[e].value)}break;case"TEXTAREA":i[t.elements[e].name]=t.elements[e].value;break;case"SELECT":switch(t.elements[e].type){case"select-one":i[t.elements[e].name]=t.elements[e].value;break;case"select-multiple":for(r=t.elements[e].options.length-1;r>=0;r-=1)t.elements[e].options[r].selected&&(i[t.elements[e].name]=t.elements[e].options[r].value)}break;case"BUTTON":switch(t.elements[e].type){case"reset":case"submit":case"button":i[t.elements[e].name]=t.elements[e].value}}return i}}function i(t,e){t=n.first(t);for(var r=n.all("[name]",t),i=0;i<r.length;++i){var o=r[i];o.value=e[o.getAttribute("name")]}}t.serialize=r,t.populate=i}),jsns.define("htmlrest.formlifecycle",["htmlrest.toggles","htmlrest.rest"],function(t,e,n,r){function i(t){var e=null,i=this;t.setListener({submit:function(t){t.preventDefault(),i.submit()},tryAgain:function(t){t.preventDefault(),e()}});var o=t.getToggle("load"),s=t.getToggle("main"),a=t.getToggle("fail"),l=new n.Group(o,s,a),u=t.getModel("settings");this.populate=function(){l.show(o),r.get(u.getSrc(),function(t){u.setData(t),l.show(s)},function(t){e=i.populate,l.show(a)})},this.submit=function(){l.show(o);var t=u.getData();r.post(u.getSrc(),t,function(t){l.show(s)},function(t){e=i.submit,l.show(a)})}}e.exports=i}),jsns.define("htmlrest.iter",null,function(t,e){function n(t,e){var n=0;return function(){return n<t.length?e(t[n++]):null}}e.exports=n}),jsns.define("htmlrest.models",["htmlrest.form","htmlrest.textstream","htmlrest.components","htmlrest.typeidentifiers","htmlrest.domquery"],function(t,e,n,r,i,o,s){function a(t,e){this.setData=function(e){n.populate(t,e)},this.appendData=this.setData,this.getData=function(){return n.serialize(t)},this.getSrc=function(){return e}}function l(t,e,n){this.setData=function(e,n){i.empty(t),this.appendData(e,n)},this.appendData=function(e,r){o.isArray(e)||o.isFunction(e)?i.repeat(n,t,e,r):e&&i.single(n,t,e,r)},this.getData=function(){return{}},this.getSrc=function(){return e}}function u(t,e){var n=void 0;this.setData=function(e){n=c(e,t,n)},this.appendData=this.setData,this.getData=function(){return{}},this.getSrc=function(){return e}}function c(t,e,n){if(void 0===n)n=[],s.iterateNodes(e,NodeFilter.SHOW_TEXT,function(e){var i=new r(e.textContent);i.foundVariable()&&(e.textContent=i.format(t),n.push({node:e,stream:i}))});else for(var i=0;i<n.length;++i){var o=n[i];o.node.textContent=o.stream.format(t)}return n}function f(t){var e=t.getAttribute("data-hr-model-src");if("FORM"===t.nodeName)return new a(t,e);var n=t.getAttribute("data-hr-model-component");return n?new l(t,e,n):new u(t,e)}function d(){this.setData=function(t){},this.appendData=this.setData,this.getData=function(){return{}},this.getSrc=function(){return""}}t.build=f,t.NullModel=d}),jsns.define("htmlrest.rest",null,function(t,e){function n(t,e,n){if(200===t.status){if(void 0!==e){var r=void 0;try{r=JSON.parse(t.response)}catch(i){r=t.response}e(r)}}else if(void 0!==n){try{r=JSON.parse(t.response)}catch(i){r=t.response}n(r)}}function r(t,e,n,r){a(t,"POST",e,n,r)}function i(t,e,n,r){a(t,"PUT",e,n,r)}function o(t,e,n,r){a(t,"DELETE",e,n,r)}function s(t,e,r,i){void 0===r&&(r=e),(void 0===i||i===!1)&&(t+=t.indexOf("?")>-1?"&":"?",t+="noCache="+(new Date).getTime());var o=new XMLHttpRequest;o.open("GET",t),o.onload=function(){n(o,e,r)},o.send()}function a(t,e,r,i,o){void 0===o&&(o=i);var s=new XMLHttpRequest;s.open(e,t),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){n(s,i,o)},s.send(JSON.stringify(r))}function l(t,e,r,i){void 0===i&&(i=r);var o=null;e instanceof FormData?o=e:(o=new FormData,o.append("file",e));var s=new XMLHttpRequest;s.open("POST",t),s.onload=function(){n(s,r,i)},s.send(o)}t.post=r,t.put=i,t["delete"]=o,t.get=s,t.ajax=a,t.upload=l}),jsns.define("htmlrest.storage",null,function(t,e){function n(t,e){void 0===e&&(e=null);var n=sessionStorage.getItem(t);return n=null!==n?JSON.parse(n):e}function r(t,e){sessionStorage.setItem(t,JSON.stringify(e))}function i(t,e){return s.hasOwnProperty(t)?s[t]:(void 0!==e&&this.storeInInstance(t,e),e)}function o(t,e){s[t]=e}var s={};t.getSessionJson=n,t.storeJsonInSession=r,t.getInInstance=i,t.storeInInstance=o}),jsns.define("htmlrest.textstream",["htmlrest.escape","htmlrest.typeidentifiers"],function(t,e,n,r){function i(t){this.writeObject=function(e){return t},this.writeFunction=this.writeObject}function o(t){this.writeObject=function(e){return n(e[t])},this.writeFunction=function(e){return n(e(t))}}function s(){this.writeObject=function(t){return n(t)},this.writeFunction=function(t){return n(t("this"))}}function a(t,e){(null===t||void 0===t)&&(t={});var n="";if(r.isFunction(t))for(var i=0;i<e.length;++i)n+=e[i].writeFunction(t);else for(var i=0;i<e.length;++i)n+=e[i].writeObject(t);return n}function l(t){for(var e=[],n=!1,r=0,l=0,u=0,c=0;c<t.length;++c)switch(t[c]){case"{":"{"!==t[c+1]&&(l=c);break;case"}":if((c+1===t.length||"}"!==t[c+1])&&(u=c,u-1>l)){e.push(new i(t.substring(r,l)));var f=t.substring(l+1,u);e.push("this"===f?new s:new o(f)),r=c+1,n=!0}}r<t.length&&e.push(new i(t.substring(r,t.length))),this.format=function(t){return a(t,e)},this.foundVariable=function(){return n}}e.exports=l}),jsns.define("htmlrest.toggles",["htmlrest.typeidentifiers"],function(t,e,n){function r(t){c.push(t)}function i(t){this.on=function(){t&&t.on()},this.off=function(){t&&t.off()}}function o(t,e,n,r){e=e||"",n=n||"";var i=t.style.cssText||"";this.on=function(){t.style.cssText=i+e,r&&r.on()},this.off=function(){t.style.cssText=i+n,r&&r.off()}}function s(t,e,n,r,i){function o(){r&&(t.classList.remove(r),t.removeEventListener("transitionend",s),t.removeEventListener("animationend",s),t.addEventListener("transitionend",s),t.addEventListener("animationend",s))}function s(){t.removeEventListener("transitionend",s),t.removeEventListener("animationend",s),t.classList.add(r)}e=e||"",n=n||"";var a=t.getAttribute("class")||"";this.on=function(){t.setAttribute("class",a+" "+e),o(),i&&i.on()},this.off=function(){t.setAttribute("class",a+" "+n),o(),i&&i.off()}}function a(){var t=arguments;this.add=function(e){t.push(e)},this.show=function(e){for(var n=0;n<t.length;++n)t[n].off();e.on()}}function l(t){var e=t.getAttribute("data-hr-style-on"),n=t.getAttribute("data-hr-style-off"),r=t.getAttribute("data-hr-class-on"),a=t.getAttribute("data-hr-class-off"),l=t.getAttribute("data-hr-class-idle"),u=null;(e||n)&&(u=new o(t,e,n,u)),(r||a)&&(u=new s(t,r,a,l,u));for(var f=0;f<c.length;++f)u=c[f](t,u);return null===u&&(u=new i(u)),u}function u(t){return n.isObject(t)&&t.constructor.prototype==i.prototype}var c=[];t.addTogglePlugin=r,t.NullToggle=i,t.Group=a,t.build=l,t.isNullToggle=u}),jsns.define("htmlrest.typeidentifiers",null,function(t,e){function n(t){return Array.isArray(t)}function r(t){return"string"==typeof t}function i(t){return"function"==typeof t}function o(t){return"object"==typeof t}"undefined"==typeof Array.isArray&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),t.isArray=n,t.isString=r,t.isFunction=i,t.isObject=o}),jsns.run(["htmlrest.toggles"],function(t,e,n){function r(t,e){var n=new Modal(t);this.on=function(){n.open(),e&&e.on()},this.off=function(){n.close(),e&&e.off()}}n.addTogglePlugin(function(t,e){return t.classList.contains("modal")&&(e=new r(t,e)),e})});
//# sourceMappingURL=htmlrest.min.js.map
