"use strict";var jsns=function(){function t(t){return void 0!==a[t]}function e(t){return void 0!==l[t]}function n(t){var e=o(l[t]);return e&&delete l[t],e}function r(){this.exports={}}function o(o){for(var i=o.dependencies,s=!0,l=0;l<i.length;++l){var u=i[l];u.loaded=t(u.name),!u.loaded&&e(u.name)&&(u.loaded=n(u.name)),s=s&&u.loaded}if(s){var c=new r;o.name&&(a[o.name]=c);for(var f=[c.exports,c],l=0;l<i.length;++l){var u=i[l];f.push(a[u.name].exports)}o.factory.apply(c,f)}return s}function i(e,n,r){if(this.name=e,this.factory=r,this.dependencies=[],n)for(var o=0;o<n.length;++o){var i=n[o];this.dependencies.push({name:i,loaded:t(i)})}}function s(){for(var t=0;t<u.length;++t){var e=u[t];o(e)&&u.splice(t--,1)}}var a={},l={},u=[];return{run:function(t,e){u.push(new i(null,t,e)),s()},define:function(t,e,n){l[t]=new i(t,e,n),s()},debug:function(){if(u.length>0)for(var e=0;e<u.length;++e){var n=u[e];console.log("Runner waiting "+n);for(var r=0;r<n.dependencies.length;++r){var o=n.dependencies[r];t(o.name)||console.log("  dependency "+o.name)}}else console.log("No runners remaining.")}}}();!function(){String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;--n>=0&&e.item(n)!==this;);return n>-1})}(),jsns.define("htmlrest.bindingcollection",["htmlrest.escape","htmlrest.typeidentifiers","htmlrest.domquery","htmlrest.textstream","htmlrest.toggles","htmlrest.models"],function(t,e,n,r,o,i,s,a){function l(t,e){this.execute=function(n){var r=e[t];r&&r.call(this,n)}}function u(t,e){for(var n=0;n<t.length;++n){var r=t[n];o.iterateNodes(r,NodeFilter.SHOW_ELEMENT,function(t){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];if(r.name.startsWith("data-hr-on-")){var o=new l(r.value,e);t.addEventListener(r.name.substr(11),o.execute)}}})}}function c(t,e,n){var r=n[t];if(void 0===r)for(var i="[data-hr-toggle="+t+"]",a=0;a<e.length;++a){var l=e[a],u=o.first(i,l);if(u)return r=s.build(u),n[t]=r,r;r=null}return null===r&&(r=new s.NullToggle),r}function f(t,e,n){var r=n[t];if(void 0===r)for(var i="[data-hr-model="+t+"]",s=0;s<e.length;++s){var l=e[s],u=o.first(i,l);if(u)return r=a.build(u),n[t]=r,r;r=null}return null===r&&(r=new a.NullModel),r}function d(t){for(var e={},n=0;n<t.length;++n){var r=t[n];o.iterateNodes(r,NodeFilter.SHOW_ELEMENT,function(t){for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n];r.name.startsWith("data-hr-config-")&&(e[r.name.substr(15)]=r.value)}})}return e}function h(t){t=o.all(t);var e=void 0,n=void 0,r=void 0;this.setListener=function(e){u(t,e)},this.setData=function(n){e=bindData(n,t,e)},this.getToggle=function(e){return void 0===n&&(n={}),c(e,t,n)},this.getModel=function(e){return void 0===r&&(r={}),f(e,t,r)},this.getConfig=function(){return d(t)}}e.exports=h}),jsns.run(["htmlrest.domquery","htmlrest.bindingcollection","htmlrest.textstream","htmlrest.components"],function(t,e,n,r,o,i){function s(t,e,n,o){for(var i=e.format(t),s=f(i),a=[],l=0;l<s.length;++l){var u=s[l];n.insertBefore(u,o),a.push(u)}return new r(a)}function a(t){var e=t.getAttribute("data-hr-component");null===e&&(e="AnonTemplate_"+u++,t.parentElement.setAttribute("data-hr-model-component",e));var n=t;if(l){var n=document.createElement("div");n.appendChild(document.importNode(t.content,!0))}for(var r=n.getElementsByTagName("TEMPLATE");r.length>0;)a(r[0]);var c=n.innerHTML.trim();t.parentNode.removeChild(t),i.register(e,function(t,n,r){var a=new o(c);return i.register(e,function(t,e,n){return s(t,a,e,n)}),s(t,a,n,r)})}for(var l=("content"in document.createElement("template")),u=0,c=document.getElementsByTagName("TEMPLATE");c.length>0;)a(c[0]);var f=function(t){var e={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],body:[0,"",""],_default:[1,"<div>","</div>"]};e.optgroup=e.option,e.tbody=e.tfoot=e.colgroup=e.caption=e.thead,e.th=e.td;var n=/<\s*\w.*?>/g.exec(t),r=document.createElement("div");if(null!=n){var r,o=n[0].replace(/</g,"").replace(/>/g,"").split(" ")[0],i=e[o]||e._default;t=i[1]+t+i[2],r.innerHTML=t;for(var s=i[0];s--;)r=r.lastChild}else r.innerHTML=t;return r.childNodes}}),jsns.define("htmlrest.components",["htmlrest.typeidentifiers","htmlrest.domquery"],function(t,e,n,r){function o(t,e,n,r){return l(t,n,e,null,r)}function i(t,e){u[t]=e}function s(t,e,r,o){for(var i=null,i=e.firstElementChild;null!=i&&!i.hasAttribute("data-htmlrest-insert");)i=i.nextElementSibling;var s=document.createDocumentFragment();if(Array.isArray(r))for(var a=0;a<r.length;++a)l(t,r[a],s,null,o);else if(n.isFunction(r))for(var u=r();null!=u;)l(t,u,s,null,o),u=r();else if(n.isObject(r))for(var c in r)l(t,r[c],s,null,o);e.insertBefore(s,i)}function a(t){t=r.first(t);for(var e=t.firstChild,n=null;null!=e;)n=e.nextSibling,1===e.nodeType&&e.hasAttribute("data-htmlrest-keep")||t.removeChild(e),e=n}function l(t,e,n,o,i){if(n=r.first(n),u.hasOwnProperty(t)){var s=u[t](e,n,o);return void 0!==i&&i(s,e),s}console.log("Failed to create component '"+t+"', cannot find factory, did you forget to define it on the page?")}var u={};t.single=o,t.register=i,t.repeat=s,t.empty=a}),jsns.define("htmlrest.controller",["htmlrest.bindingcollection","htmlrest.domquery"],function(t,e,n,r){function o(t,e,o){r.iterate('[data-hr-controller="'+t+'"]',null,function(t){var r=new n(t),i=new e(r,o,null);r.setListener(i),t.removeAttribute("data-hr-controller")})}function i(t,e){return function(n,r){var o=new t(n,e,r);n.setListener(o)}}t.create=o,t.createOnCallback=i}),jsns.define("htmlrest.domquery",["htmlrest.typeidentifiers"],function(t,e,n){function r(t,e){return n.isString(t)&&(t=void 0!==e?this.matches(e,t)?e:e.querySelector(t):document.querySelector(t)),t}function o(t,e,r){if(n.isString(t))void 0===r&&(r=[]),void 0!==e?this.matches(e,t)?r.push(e):u(e.querySelectorAll(t),r):u(document.querySelectorAll(t),r);else if(n.isArray(t))if(void 0===r)r=t;else for(var o=0;o<t.length;++o)r.push(t[o]);else void 0===r?r=[t]:r.push(t);return r}function i(t,e,r){if(n.isString(t))e?this.matches(e,t)?r(e):c(e.querySelectorAll(t),r):c(document.querySelectorAll(t),r);else if(n.isArray(t))for(var o=0;o<t.length;++o)r(t[o]);else r(t)}function s(t){return!0}function a(t,e,n){for(var r,o=document.createNodeIterator(t,e,s,!1);r=o.nextNode();)n(r)}function l(t,e){return t.matches(e)}function u(t,e){for(var n=0;n<t.length;++n)e.push(t[n])}function c(t,e){for(var n=0;n<t.length;++n)e(t[n])}t.first=r,t.all=o,t.iterate=i,t.iterateNodes=a,t.matches=l}),jsns.define("htmlrest.escape",null,function(t,e){function n(t){t=String(t);for(var e={textStart:0,bracketStart:0,output:""},n=0;n<t.length;++n)switch(t[n]){case"<":r(n,t,e,"&lt;");break;case">":r(n,t,e,"&gt;");break;case'"':r(n,t,e,"&quot;");break;case"'":r(n,t,e,"&#39;")}return e.textStart<t.length&&(e.output+=t.substring(e.textStart,t.length)),e.output}function r(t,e,n,r){n.bracketStart=t,n.output+=e.substring(n.textStart,n.bracketStart)+r,n.textStart=t+1}e.exports=n}),jsns.define("htmlrest.form",["htmlrest.domquery"],function(t,e,n){function r(t){if(t=n.first(t),t&&"FORM"===t.nodeName){var e,r,o={};for(e=t.elements.length-1;e>=0;e-=1)if(""!==t.elements[e].name)switch(t.elements[e].nodeName){case"INPUT":switch(t.elements[e].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":case"file":o[t.elements[e].name]=t.elements[e].value;break;case"checkbox":case"radio":t.elements[e].checked&&(o[t.elements[e].name]=t.elements[e].value)}break;case"TEXTAREA":o[t.elements[e].name]=t.elements[e].value;break;case"SELECT":switch(t.elements[e].type){case"select-one":o[t.elements[e].name]=t.elements[e].value;break;case"select-multiple":for(r=t.elements[e].options.length-1;r>=0;r-=1)t.elements[e].options[r].selected&&(o[t.elements[e].name]=t.elements[e].options[r].value)}break;case"BUTTON":switch(t.elements[e].type){case"reset":case"submit":case"button":o[t.elements[e].name]=t.elements[e].value}}return o}}function o(t,e){t=n.first(t);for(var r=n.all("[name]",t),o=0;o<r.length;++o){var i=r[o];i.value=e[i.getAttribute("name")]}}t.serialize=r,t.populate=o}),jsns.define("htmlrest.formlifecycle",["htmlrest.toggles","htmlrest.rest"],function(t,e,n,r){function o(t){var e=null,o=this;t.setListener({submit:function(t){t.preventDefault(),o.submit()},tryAgain:function(t){t.preventDefault(),e()}});var i=t.getToggle("load"),s=t.getToggle("main"),a=t.getToggle("fail"),l=new n.Group(i,s,a),u=t.getModel("settings");this.populate=function(){l.show(i),r.get(u.getSrc(),function(t){u.setData(t),l.show(s)},function(t){e=o.populate,l.show(a)})},this.submit=function(){l.show(i);var t=u.getData();r.post(u.getSrc(),t,function(t){l.show(s)},function(t){e=o.submit,l.show(a)})}}e.exports=o}),jsns.define("htmlrest.iter",null,function(t,e){function n(t,e){var n=0;return function(){return n<t.length?e(t[n++]):null}}e.exports=n}),jsns.define("htmlrest.models",["htmlrest.form","htmlrest.textstream","htmlrest.components","htmlrest.typeidentifiers","htmlrest.domquery"],function(t,e,n,r,o,i,s){function a(t,e){this.setData=function(e){n.populate(t,e)},this.appendData=this.setData,this.getData=function(){return n.serialize(t)},this.getSrc=function(){return e}}function l(t,e,n){this.setData=function(e,n){o.empty(t),this.appendData(e,n)},this.appendData=function(e,r){i.isArray(e)||i.isFunction(e)?o.repeat(n,t,e,r):e&&o.single(n,t,e,r)},this.getData=function(){return{}},this.getSrc=function(){return e}}function u(t,e){var n=void 0;this.setData=function(e){n=c(e,t,n)},this.appendData=this.setData,this.getData=function(){return{}},this.getSrc=function(){return e}}function c(t,e,n){if(void 0===n)n=[],s.iterateNodes(e,NodeFilter.SHOW_TEXT,function(e){var o=new r(e.textContent);o.foundVariable()&&(e.textContent=o.format(t),n.push({node:e,stream:o}))});else for(var o=0;o<n.length;++o){var i=n[o];i.node.textContent=i.stream.format(t)}return n}function f(t){var e=t.getAttribute("data-hr-model-src");if("FORM"===t.nodeName)return new a(t,e);var n=t.getAttribute("data-hr-model-component");return n?new l(t,e,n):new u(t,e)}function d(){this.setData=function(t){},this.appendData=this.setData,this.getData=function(){return{}},this.getSrc=function(){return""}}t.build=f,t.NullModel=d}),jsns.define("htmlrest.rest",null,function(t,e){function n(t,e,n){if(200===t.status){if(void 0!==e){var r=void 0;try{r=JSON.parse(t.response)}catch(o){r=t.response}e(r)}}else if(void 0!==n){try{r=JSON.parse(t.response)}catch(o){r=t.response}n(r)}}function r(t,e,n,r){a(t,"POST",e,n,r)}function o(t,e,n,r){a(t,"PUT",e,n,r)}function i(t,e,n,r){a(t,"DELETE",e,n,r)}function s(t,e,r,o){void 0===r&&(r=e),(void 0===o||o===!1)&&(t+=t.indexOf("?")>-1?"&":"?",t+="noCache="+(new Date).getTime());var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){n(i,e,r)},i.send()}function a(t,e,r,o,i){void 0===i&&(i=o);var s=new XMLHttpRequest;s.open(e,t),s.setRequestHeader("Content-Type","application/json"),s.onload=function(){n(s,o,i)},s.send(JSON.stringify(r))}function l(t,e,r,o){void 0===o&&(o=r);var i=null;e instanceof FormData?i=e:(i=new FormData,i.append("file",e));var s=new XMLHttpRequest;s.open("POST",t),s.onload=function(){n(s,r,o)},s.send(i)}t.post=r,t.put=o,t["delete"]=i,t.get=s,t.ajax=a,t.upload=l}),jsns.define("htmlrest.storage",null,function(t,e){function n(t,e){void 0===e&&(e=null);var n=sessionStorage.getItem(t);return n=null!==n?JSON.parse(n):e}function r(t,e){sessionStorage.setItem(t,JSON.stringify(e))}function o(t,e){return s.hasOwnProperty(t)?s[t]:(void 0!==e&&this.storeInInstance(t,e),e)}function i(t,e){s[t]=e}var s={};t.getSessionJson=n,t.storeJsonInSession=r,t.getInInstance=o,t.storeInInstance=i}),jsns.define("htmlrest.textstream",["htmlrest.escape"],function(t,e,n){function r(t){this.write=function(e){return t}}function o(t){this.write=function(e){return e?n(e[t]):""}}function i(){this.write=function(t){return t?n(t):""}}function s(t,e){for(var n="",r=0;r<e.length;++r)n+=e[r].write(t);return n}function a(t){for(var e=[],n=!1,a=0,l=0,u=0,c=0;c<t.length;++c)switch(t[c]){case"{":"{"!==t[c+1]&&(l=c);break;case"}":if((c+1===t.length||"}"!==t[c+1])&&(u=c,u-1>l)){e.push(new r(t.substring(a,l)));var f=t.substring(l+1,u);e.push("this"===f?new i:new o(f)),a=c+1,n=!0}}a<t.length&&e.push(new r(t.substring(a,t.length))),this.format=function(t){return s(t,e)},this.foundVariable=function(){return n}}e.exports=a}),jsns.define("htmlrest.toggles",["htmlrest.typeidentifiers"],function(t,e,n){function r(t){c.push(t)}function o(t){this.on=function(){t&&t.on()},this.off=function(){t&&t.off()}}function i(t,e,n,r){e=e||"",n=n||"";var o=t.style.cssText||"";this.on=function(){t.style.cssText=o+e,r&&r.on()},this.off=function(){t.style.cssText=o+n,r&&r.off()}}function s(t,e,n,r,o){function i(){r&&(t.classList.remove(r),t.removeEventListener("transitionend",s),t.removeEventListener("animationend",s),t.addEventListener("transitionend",s),t.addEventListener("animationend",s))}function s(){t.removeEventListener("transitionend",s),t.removeEventListener("animationend",s),t.classList.add(r)}e=e||"",n=n||"";var a=t.getAttribute("class")||"";this.on=function(){t.setAttribute("class",a+" "+e),i(),o&&o.on()},this.off=function(){t.setAttribute("class",a+" "+n),i(),o&&o.off()}}function a(){var t=arguments;this.add=function(e){t.push(e)},this.show=function(e){for(var n=0;n<t.length;++n)t[n].off();e.on()}}function l(t){var e=t.getAttribute("data-hr-style-on"),n=t.getAttribute("data-hr-style-off"),r=t.getAttribute("data-hr-class-on"),a=t.getAttribute("data-hr-class-off"),l=t.getAttribute("data-hr-class-idle"),u=null;(e||n)&&(u=new i(t,e,n,u)),(r||a)&&(u=new s(t,r,a,l,u));for(var f=0;f<c.length;++f)u=c[f](t,u);return null===u&&(u=new o(u)),u}function u(t){return n.isObject(t)&&n.constructor.prototype==o.prototype}var c=[];t.addTogglePlugin=r,t.NullToggle=o,t.Group=a,t.build=l,t.isNullToggle=u}),jsns.define("htmlrest.typeidentifiers",null,function(t,e){function n(t){return Array.isArray(t)}function r(t){return"string"==typeof t}function o(t){return"function"==typeof t}function i(t){return"object"==typeof data}"undefined"==typeof Array.isArray&&(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),t.isArray=n,t.isString=r,t.isFunction=o,t.isObject=i}),jsns.run(["htmlrest.toggles"],function(t,e,n){function r(t,e){var n=new Modal(t);this.on=function(){n.open(),e&&e.on()},this.off=function(){n.close(),e&&e.off()}}n.addTogglePlugin(function(t,e){return t.classList.contains("modal")&&(e=new r(t,e)),e})});
//# sourceMappingURL=htmlrest.min.js.map
